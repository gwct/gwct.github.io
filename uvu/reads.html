
<!doctype html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">	
    <link rel='shortcut icon' href='img/favicon.ico' type='image/x-icon'/ >
    <link type="text/css" rel="stylesheet" href="css/grid.css"  media="screen,projection" />
    <link type="text/css" rel="stylesheet" href="css/global.css"  media="screen,projection" />
    <link href="https://fonts.googleapis.com/css?family=Lato:300" rel="stylesheet"> 
    <title>UVU Genomics - Lab 01 - Reads</title>
</head>

<body>
    <div class="row" id="desktop_nav">
		<div class="col-3-24" id="margin"></div>
		<div class="col-3-24" id="nav_link_cell"><a class="nav_link" href="index.html">Home</a></div>
		<div class="col-3-24" id="nav_link_cell"><a class="nav_link" href="syllabus.html">Syllabus</a></div>
		<div class="col-3-24 dropdown" id="nav_link_cell">
			<a href="start.html" class="nav_link">Lab Assignments</a>
			<div class="dropdown_container desktop_drop">
				<ul class="dropdown_list">
					<li class="dropdown_list_item"><a href="start.html" id="dropdown_nav_link">Start</a></li>
					<li class="dropdown_list_item"><a href="#" id="dropdown_nav_link">Reads</a></li>
					<li class="dropdown_list_item"><a href="assembly.html" id="dropdown_nav_link">Assembly</a></li>
					<li class="dropdown_list_item"><a href="mapping.html" id="dropdown_nav_link">Mapping</a></li>
					<li class="dropdown_list_item"><a href="iterative-mapping.html" id="dropdown_nav_link">Iterative mapping</a></li>
				</ul>
			</div>
		</div>
		<div class="col-3-24" id="nav_link_cell"><a class="nav_link" href="terms.html">Terminology</a></div>
		<div class="col-3-24" id="nav_link_cell"><a class="nav_link" href="programs.html">Programs</a></div>
		<div class="col-3-24" id="nav_link_cell"><a class="nav_link" href="links.html">Links</a></div>
		<div class="col-3-24" id="margin"></div>
	</div>

	<div class="row" id="mobile_nav">
		<div class="col-24-24 dropdown" id="nav_link_cell">
			<a href="#" class="nav_link"><img id="mobile_logo_nav" src="img/nav.png"></a>
			<div class="dropdown_container mobile_drop">
				<ul class="dropdown_list">
					<li class="dropdown_list_item"><a href="index.html" id="mobile_nav_link">Home</a></li>
					<li class="dropdown_list_item"><a href="syllabus.html" id="mobile_nav_link">Syllabus</a></li>
					<li class="dropdown_list_item"><a href="start.html" id="mobile_nav_link">Lab Assignments</a></li>
					<li class="dropdown_list_item"><a href="terms.html" id="mobile_nav_link">Terminology</a></li>
					<li class="dropdown_list_item"><a href="programs.html" id="mobile_nav_link">Programs</a></li>
					<li class="dropdown_list_item"><a href="links.html" id="mobile_nav_link">Links</a></li>
				</ul>
			</div>
		</div>
	</div>

    <a class="internal-link" name="intro"></a>
<div class="row" id="header">Sequences & Reads</div>

    <div class="row" id="body-row">
        <div class="col-3-24" id="side-nav-cont">
            <div id="side-nav">
                <span id="side-header">Page contents</span>
                <ul>
                    <li><a href="reads.html#intro">Introduction</a></li>
                    <li><a href="reads.html#drosophila">Drosophila data</a></li>
                    <li><a href="reads.html#prep">Lab prep</a></li>
                    <li><a href="reads.html#fasta">FASTA format</a></li>
                    <li><a href="reads.html#fastq">FASTQ format</a></li>
                    <li><a href="reads.html#phred">Phred Quality scores</a></li>
                    <li><a href="reads.html#act1">ACTIVITY 1</a></li>
                    <li><a href="reads.html#fastqc">Assessing reads with Fastqc</a></li>
                    <li><a href="reads.html#assign1">ASSIGNMENT</a></li>
                </ul>
            </div>
        </div>

        <div class="col-21-24" id="main-cont">
            <div class="row" id="top-row-cont">
                <div class="col-24-24" id="top-row"></div>
            </div>

            <div class="row" id="top-row-cont">
                <div class="col-24-24" id="top-row"></div>
            </div>

            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Introduction</div>
                </div>
            </div>
            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
                                <p>
                                    Welcome to the first lab session of Genomics!
                                </p>

                                <p>
                                    Today we'll be going over common file formats and encodings that deal with <b>raw sequence data</b> that you would receive from a
                                    sequencing machine, company, or database. Our goal is to become familiar with handling these formats.
                                </p>

                                <!-- <div class="row" id="img-row">
                                    <div class="col-24-24" id="img-col">
                                        <img id="res-img" src="img/congen-interface.png">
                                        <center><span class="fig-caption">Figure 1.1: The RStudio interface for running commands and browsing files.</span></center>
                                    </div>
                                </div> -->

                                <p>
                                    Most of our work today will be done as commands typed into a command line. Throughout this walkthrough, commands will be presented
                                    as follows:
                                </p>

                                <center><pre class="cmd"><code>this is an example command</code></pre></center>

                                <p>Following each command will be a table that goes through and explains each part of the command explicitly:</p>

                                <div class="table-cont">
                                    <table class="cmd-table">
                                        <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                        <tr>
                                            <td class="tcol-1">this</td><td class="tcol-2">An example command</td>
                                        </tr>
                                        <tr>
                                            <td class="tcol-1">is</td><td class="tcol-2">An example option used in the example command</td>
                                        </tr>
                                        <tr>
                                            <td class="tcol-1">an</td><td class="tcol-2">An example option used in the example command</td>
                                        </tr>
                                        <tr>
                                            <td class="tcol-1">example</td><td class="tcol-2">An example option used in the example command</td>
                                        </tr>
                                        <tr>
                                            <td class="tcol-1">command</td><td class="tcol-2">An example option used in the example command</td>
                                        </tr>
                                    </table>
                                </div>

                                <p>
                                    The goal of providing these tables is to break-down some of the 'black box' that command line tools can sometimes feel like.
                                    Hopefully this is helpful. If not, feel free to skip over these tables when you see them!
                                </p>

                                <div id="msg_cont">
                                    <div id="msg">
                                        <div id="msg_banner">Tip - Help menus</div>
                                        <div id="msg_text">
                                            <p>
                                                A general convention among command-line software is to provide a help menu for programs that lists common options. These can generally
                                                viewed from the command line with the <code class="inline">-h</code> option as follows:
                                            </p>

                                            <center><code class="inline">&lt;program&gt; -h</code> &nbsp;<em>-or-</em>&nbsp; <code class="inline">&lt;program&gt; &lt;sub-program&gt; -h</code></center>

                                            <p>For Linux commands, documentation is generally available with the <code class="inline">man</code> command (man is short for manual):</p>

                                            <center><code class="inline">man &lt;command&gt;</code></center>

                                            <p><code class="inline">man</code> opens a text viewer that can be navigated with the arrow keys and exited simply by typing <code class="inline">q</code>.
                                                If you're ever stuck or want to know more about a program's options, try these!
                                            </p>
                                            <p></p>
                                        </div>
                                    </div>
                                </div>

                                <p>
                                    Commands that you should run will have a <span style="background-color:#c6ecd9;">green background</span>. We will also provide some commands that are beneficial
                                    to see, but do not necessarily need to be run using a <span style="background-color:#ffb3b3;">red background</span>, like so:
                                </p>

                                <center><pre class="cmd-ne"><code>this is an example command that won't be run</code></pre></center>

                                <p>
                                    Additionally, one of the most important and often overlooked parts of bioinformatics analyses is to simply look at one's data.
                                    There will be several points where we stop to look at the output of a given program or command. When we do, a snippet
                                    of the output will be presented in the walkthrough as follows:
                                </p>

                                <pre class="text"><code>Here is some made up output.
Looking at your data is very important!
You can catch problems before you use the data in later analyses.</code></pre>
                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="drosophila"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Drosophila data</div>
                </div>
            </div>
            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
                            <p>
                                Today we'll be working with short reads from the relatively small 150Mb genome from <em>Drosophila pseudoobscura</em>. 
                                Many times we will limit our data to just chromosome 2 (32Mb) of </em>D. pseudoobscura</em> to speed up run times even more.
                            </p>

                            <p>
                                <em>D. pseudoobscura</em> is a species of fruit fly that diverged from the well known <em>D. melanogaster</em> model species roughly 50
                                million years ago. <em>D. pseudoobscura</em> chromosome 2 is homologous to <em>D. melanogaster</em> chromosome arm 3R.
                            </p>

                            <div class="row" id="img-row">
                                <div class="col-4-24" id="margin"></div>
                                <div class="col-16-24" id="img-col">
                                    <img id="res-img" src="img/drosophila.png">
                                    <center><span class="fig-caption">Figure 1.2: Drosophila phylogeny and homology between chromosome arms. 
                                        From <a href="https://www.genetics.org/content/179/3/1601" target="blank">Schaeffer et al. 2008</a></span></center>
                                </div>
                                <div class="col-4-24" id="margin"></div>
                            </div>

                            <p>Using these data, we'll be performing the following tasks today:</p>

                            <ol>
                                <li>Looking at sequences in FASTA and FASTQ format.</li>
                                <li>Learning about quality score encodings in sequence reads and converting between various encodings.</li>
                                <li>Assessing read quality with the FastQC software.</li>
                                <li><b>ASSIGNMENT</b>: Writing a script to assess base quality on our own.</li>
                            </ol>
                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="prep"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Preparing Your Project</div>
                </div>
            </div>
            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
                            <h3>Copying input data</h3>

                            <p>The data we'll be working with today are mainly sequences in FASTA and FASTQ format (more on those in a moment). The input 
                                files are located on the server at <code class="inline">/home/gwct/genomics-labs/lab01/</code>. Let's make a copy of this 
                                directory in our home directory so we don't have to worry about that path anymore. First, make sure you are in your Genomics directory:
                            </p>

                            <center><pre class="cmd"><code>cd ~/genomics/</code></pre></center>

                            <div class="table-cont">
                                <table class="cmd-table">
                                    <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1">cd</td><td class="tcol-2">The Linux change directory command</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">~</td><td class="tcol-2">The path to the directory you want to change to. In bash, 
                                            <code class="inline">~</code> is a shortcut meaning "the current user's home directory."</td>
                                    </tr>
                                </table>
                            </div>                                
                            
                            <p>Now let's make a copy of the data directory:</p>

                            <center><pre class="cmd"><code>cp -r /home/gwct/genomics-labs/lab01/ .</code></pre></center>

                            <div class="table-cont">
                                <table class="cmd-table">
                                    <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1">cp</td><td class="tcol-2">The Linux copy command</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">-r</td><td class="tcol-2">Recursively copy all files in a directory.</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">/home/gwct/genomics-labs/lab01/</td><td class="tcol-2">The path to the directory you want to copy.</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">.</td><td class="tcol-2">The path to the new copy. In bash, <code class="inline">.</code> is a shortcut meaning
                                            "the same name." So this will copy the directory to our current location with the name <code class="inline">congen-assembly</code></td>
                                    </tr>
                                </table>
                            </div>            

                            <p>Let's move into this folder with <code class="inline">cd</code> again since we'll spend the rest of the workshop here:</p>

                            <center><pre class="cmd"><code>cd lab01</code></pre></center>

                            <div class="table-cont">
                                <table class="cmd-table">
                                    <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1">cd</td><td class="tcol-2">The Linux change directory command</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">lab01</td><td class="tcol-2">The path to the directory you want to change to.</td>
                                    </tr>
                                </table>
                            </div>                                      
                            
                            <p>
                                And now we can look at what is in that folder with the <code class="inline">ls</code> command. Make sure you've
                                selected your Terminal window and type the following:
                            </p>

                            <center><pre class="cmd"><code>ls</code></pre></center>
                            <div class="table-cont">
                                <table class="cmd-table">
                                    <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1">ls</td><td class="tcol-2">The Linux list directory command to view the files in a folder. Shows files in current folder by default.</td>
                                    </tr>
                                </table>
                            </div>

                            <p>You should see the following folders listed</p>

                            <div class="table-cont">
                                <table class="norm-table">
                                    <thead><th class="tcol-1">Folder</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1"><code class="inline">data/</code></td><td class="tcol-2">A folder containing the <em>Drosophila</em> 
                                            data used in this lab.</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1"><code class="inline">scripts/</code></td><td class="tcol-2">The folder where you will write and run scripts.
                                            Any pre-made scripts will also be located here.
                                    </tr>
                                </table>
                            </div> 

                            <p>
                                Let's also take a look at what's in the <code class="inline">data</code> folder so we know what we'll be working with:
                            </p>


                            <center><pre class="cmd"><code>ls data</code></pre></center>
                            <div class="table-cont">
                                <table class="cmd-table">
                                    <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1">ls</td><td class="tcol-2">The Linux list directory command to view the files in a folder. Shows files in current folder by default.</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">ls</td><td class="tcol-2">By default, ls lists the contents of the current directory. You can also supply a path to another
                                            directory, such as the data folder, to list it's contents.
                                        </td>
                                    </tr>
                                </table>
                            </div>

                            <p>You should see the following folders listed</p>

                            <div class="table-cont">
                                <table class="norm-table">
                                    <thead><th class="tcol-1">Folder</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1"><code class="inline">dmel-3R-reference/</code></td><td class="tcol-2">A folder containing the <em>D. melanogaster</em> chromosome 3R sequence file and its indices.</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1"><code class="inline">dpse-chr2-reads/</code></td><td class="tcol-2">A folder containing Illumina short reads for <em>D. pseudoobscura</em>.</td>
                                    </tr>
                                </table>
                            </div> 

                            <!-- <div id="msg_cont">
                                <div id="msg">
                                    <div id="msg_banner">Tip - Pre-generated outputs</div>
                                    <div id="msg_text">
                                        <p>
                                            We have tried to anticipate the expected outputs from the commands we run today. If you get behind or stuck on something, try moving on to the next
                                            step by adding <code class="inline">expected-outputs/</code> to the beginning of the path for input you were expected to generate for the next command.
                                            Feel free to ask us for help for any specific command.
                                        </p>

                                        <p></p>
                                    </div>
                                </div>
                            </div>                        -->

                            <h3>Preparing output directories</h3>

                            <p>
                                I like to try and think ahead about what outputs my project will produce and make those directories early on, which helps me plan out my workflows. 
                            </p>

                            <p>
                                Today we'll be running the program FastQC, which requires a pre-made output directory:
                            </p>

                            <center><pre class="cmd"><code>mkdir fastqc-output</code></pre></center>
            
                            <div class="table-cont">
                                <table class="cmd-table">
                                    <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1">mkdir</td><td class="tcol-2">The Linux make directory command</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">fastqc-output</td><td class="tcol-2">The desired name of the new directory.</td>
                                    </tr>
                                </table>
                            </div>                            
                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="fasta"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">FASTA format</div>
                </div>
            </div>
            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
        
                            <p>One common format used to store biological sequence data is the FASTA format. Let's take a look at one of the reference sequences stored in FASTA format with the following command:</p>
        
                            <center><pre class="cmd"><code>less -S data/dmel-3R-reference/Drosophila_melanogaster.BDGP6.28.dna.chromosome.3R.fa</code></pre></center>
            
                            <div class="table-cont">
                                <table class="cmd-table">
                                    <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1">less</td><td class="tcol-2">A Linux text file viewer 
                                            (use <code class="inline">&lt;up arrow&gt;</code> and <code class="inline">&lt;down arrow&gt;</code> to scroll up and down by one line 
                                            or <code class="inline">&lt;space&gt;</code> and <code class="inline">b</code> 
                                            to scroll up and down by one page, resepectively. Type <code class="inline">q</code> to exit)</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">-S</td><td class="tcol-2">Turn off line-wrapping within <code class="inline">less</code> 
                                            (use the <code class="inline">&lt;left arrow&gt;</code> and <code class="inline">&lt;right arrow&gt;</code> to scroll left and right).</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">data/dmel-3R-reference/Drosophila_melanogaster.BDGP6.28.dna.chromosome.3R.fa</td><td class="tcol-2">The path to the file you want to view</td>
                                    </tr>
                                </table>
                            </div>
            
                            <p>Here I've clipped the top of this output:</p>
            
                            <pre class="text"><code>>3R dna:chromosome chromosome:BDGP6.28:3R:1:32079331:1 REF
ACGGGACCGAGTATAGTACCAGTACGCGACCAGTACGGGAGCAGTACGGAACCAATACGG
GTCCAGTACGGGTCCAGTACGGGTCCAGTACGGGTCCAGTACGGGACCAGTACGGGACCG</code></pre>
            
                            <p>We can see that the first line begins with the greater than symbol (<code class="inline">></code>). This indicates that it is a header line for the following sequence.
                                Header lines can contain whatever information the file creator thought would be important to annotate the sequence. In most cases, it will have a name
                                for the sequence and some information about its location in the genome.</p>
            
                            <p>After the header line comes the sequence. Sequences can be split up to multiple lines, but always form a single string that refers back to the previous header. 
                                There can also be multiple headers/sequences in a single FASTA file.</p>
                                
                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>
        
            <a class="internal-link" name="fastq"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">FASTQ format</div>
                </div>
            </div>
            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
        
                            <p>Reads require a different format because they are need to store another important piece of information regarding sequence data: per-base quality scores.
                                To accomplish this, the FASTQ format is used. We can see an example of FASTQ format with the reads provided:</p>
            
                            <center><pre class="cmd"><code>zless -S data/dpse-chr2-reads/illumina/pse-chr2_1.fastq.gz</code></pre></center>
            
                            <div class="table-cont">
                                <table class="cmd-table">
                                    <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1">zless</td><td class="tcol-2">A Linux compressed text file viewer 
                                            (use <code class="inline">&lt;up arrow&gt;</code> and <code class="inline">&lt;down arrow&gt;</code> to scroll up and down by one line 
                                            or <code class="inline">&lt;space&gt;</code> and <code class="inline">b</code> 
                                            to scroll up and down by one page, resepectively. Type <code class="inline">q</code> to exit)</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">-S</td><td class="tcol-2">Turn off line-wrapping within <code class="inline">zless</code> 
                                            (use the <code class="inline">&lt;left arrow&gt;</code> and <code class="inline">&lt;right arrow&gt;</code> to scroll left and right).</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">data/dpse-chr2-reads/illumina/pse-chr2_1.fastq.gz</td><td class="tcol-2">The path to the file you want to view</td>
                                    </tr>
                                </table>
                            </div>
            
            
                            <p>Here is what the first few lines of that file should look like:</p>
                            <pre class="text"><code>@SRR11230564.32890235/1
TGATAATAAAACAACTTATTGCCCCCCTCTGGCAATACACTCTCCCGGTGTGGGGGGCCCTGACATGTAAAACGCAAATAAGAAGAATCCAGGGACAGCAGAACAAAATAATCAGAAATGCACTACTAGATCGGAAGAGCACACGTCTGAA
+
AAFFFJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
@SRR11230564.32288433/1
ATTGTGTGTATGTTGTATTTTTCCCTAAGCACTTCATTTCTTGTGTAGCGTCCAGCTAGTAGTGCATTTCTGATTATTTTGTTCTGCTGTCCCTGGATTCTTCTTATTTGCGTTTTACATGTCAGGGCCCCCCACACCGGGAGATCGGAAG
+
AAFFFJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJFJJJJJJJJJJJJJJJJJJJJJJJFJJJJJJJJJJJJJJ&lt;JJJJJAJJJJJJFJF</code></pre>
    
                            <p>So as you can see there's a lot more information here. In FASTQ, lines that start with the <code class="inline">@</code> character are the header lines and
                                can contain any amount of information about the sequence, including its ID, information about the sequencing machine that generated it, and whether
                                it is one of a pair of reads. In this case, since these reads were downloaded from the SRA, only an ID and the pair number (<code class="inline">/1</code>)
                                are included. In the snippet above there are two lines starting with <code class="inline">@</code>, meaning we are looking at information for two reads.</p>
            
                            <p>Following the header line are lines that contain sequences corresponding to that header, just like in FASTA formatted files. However, after this
                                is a line that starts with <code class="inline">+</code>. This is a linker line between the sequence and the quality scores. It can be left blank with just the
                                <code class="inline">+</code> sign, or can contain header information as well.
                            </p>
            
                            <p>After the linker line are the <b>ASCII encoded Phred-scaled quality scores.</b></p>                        
        
                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="phred"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Phred quality scores</div>
                </div>
            </div>
            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
            
                            <p>Sequencing machines read sequences as signals such as fluorescence or changes in pH or charge. Many sequencing machines can measure the intensity
                                of these signals and other factors at run-time to assign the probabilty that the base called at each position is an error. These error probabilities
                                are transformed into quality scores as follows:</p>
            
                            <p><span class="math display" id="eqn">\[ Q = -10\log P(error)\]</span></p>
            
                            <p>Scores resulting from this transformation are known as Phred scores because they were first used by the base-calling software Phred and usually range from 0 to 40.</p>
            
                            <p>To encode these scores into FASTQ files, they are converted to an ASCII character. Briefly, starting with the number 33, each character on an English keyboard
                                has a corresponding integer code (called the decimal value or DEC). To convert Phred scores to ASCII characters, we first add 33 to the Phred score and look up that
                                value in the ASCII table.</p>
            
                            <div class="row" id="img-row">
                                <div class="col-6-24" id="margin"></div>
                                <div class="col-12-24" id="img-col">
                                    <img id="res-img" src="img/ascii-table.png">
                                    <center><span class="fig-caption">Figure 2.1: ASCII table.</span></center>
                                </div>
                                <div class="col-6-24" id="margin"></div>
                            </div>
            
                            <p>Converting from ASCII characters back to error probabilities is just the reverse of this process. For example, the first ASCII character in the quality strin
                                of the first read above is <code class="inline">A</code>. Looking this up in the table, <code class="inline">A</code> has a DEC value of 65. The corresponding Phred score would then be
                                65 - 33 = 32. And then we convert back to error probability with the reverse of the above equation:
                            </p>
            
                            <p><span class="math display" id="eqn">\[ P(error) = 10^{-\frac{Q}{10}} \]</span></p>
            
                            <p>Using this equation, a score of 32 means the probability that this base is called erroneously is 0.00063</p>

                            <a class="internal-link" name="act1"></a>
                            <h2>ACTIVITY: Converting between quality score encodings and error probabilities</h2>

                            <p>
                                Using the equations and table above, fill in the following table and answer the questions below. Use any type of calculating/conversion tool you need.
                            </p>

                            <div class="table-cont">
                                <table class="main-table">
                                    <thead><th class="tcol-1">ASCII character</th><th class="tcol-2">Phred score</th><th class="tcol-2">Error probability</th></thead>
                                    <tr>
                                        <td class="tcol-1"> </td>
                                        <td class="tcol-2">40</td>
                                        <td class="tcol-2"> </td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1">!</td>
                                        <td class="tcol-2"> </td>
                                        <td class="tcol-2"> </td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1"> </td>
                                        <td class="tcol-2"> </td>
                                        <td class="tcol-2">0.000316</td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1">5</td>
                                        <td class="tcol-2"> </td>
                                        <td class="tcol-2"> </td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1"> </td>
                                        <td class="tcol-2"> </td>
                                        <td class="tcol-2">0.000126</td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1">?</td>
                                        <td class="tcol-2"> </td>
                                        <td class="tcol-2"> </td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1"> </td>
                                        <td class="tcol-2">12</td>
                                        <td class="tcol-2"> </td>
                                    </tr>
                                </table>
                            </div>

                            <h3>Questions</h3>

                            <ol>
                                <li>
                                    What Phred score is associated with a base call <b>accuracy</b> (1 - P(error)) of 99.99%? 99.9%?
                                </li>

                                <li>
                                    What do you think would be a good cut-off for quality filtering? In other words, at what quality score would you think it reasonable
                                    to remove all bases that score at or below that threshold? Remember, the human genome has roughly 3 BILLION bases.
                                </li>
                            </ol>
            
                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>


            <a class="internal-link" name="fastqc"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Assessing read quality with <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a></div>
                </div>
            </div>
            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
        
                            <p>One of the first things one should do after receiving the sequence data (reads) is to assess their quality. This means acquiring some basic
                                statistics, such as number of reads, average read length, average quality, etc.
                            </p>
            
                            <p>Fortunately, since this is such a common task, there are programs out there that help. One of the most widely used is <code class="inline">fastqc</code>.
                                This program takes as input a set of reads in <b>FASTQ</b> format and generates an HTML file with several plots that can be viewed within a web browser.
                            </p>
            
                            <p>Let's try to run <code class="inline">fastqc</code> on some of our short read (Illumina) data for <em>D. pseudoobscura</em> chromosome 2.</p>
            
                            <center><pre class="cmd"><code>fastqc data/dpse-chr2-reads/illumina/pse-chr2_1.fastq.gz data/dpse-chr2-reads/illumina/pse-chr2_2.fastq.gz -o fastqc-output/</code></pre></center>
            
                            <div class="table-cont">
                                <table class="cmd-table">
                                    <thead><th class="tcol-1">Command line parameter</th><th class="tcol-2">Description</th></thead>
                                    <tr>
                                        <td class="tcol-1">fastqc</td><td class="tcol-2">Invoke the <code class="inline">fastqc</code> program.</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">data/dpse-chr2-reads/illumina/pse-chr2_1.fastq.gz</td><td class="tcol-2">The first input read file.</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">data/dpse-chr2-reads/illumina/pse-chr2_2.fastq.gz</td><td class="tcol-2">The second input read file.</td>
                                    </tr>
                                    <tr>
                                        <td class="tcol-1">-o fastqc-output/</td><td class="tcol-2">The <code class="inline">-o</code> option specifies the output directory.</td>
                                    </tr>
                                </table>
                            </div>

                            <p>This should take less than a minute to run, during which you'll see some progress reported on the screen.</p>
            
                            <p>Unlike most of our other commands today, this won't output a text file that can be viewed easily from the terminal. Rather the HTML output should be viewed
                                in the browser. To do that, navigate to that folder on your computer using the OS's GUI. Once you're there you should see 4 files, 
                                two <code class="inline">.html</code> files and two <code class="inline">.zip</code> files. One file per type per input file. We can 
                                ignore the <code class="inline">.zip</code> for now. They contain the raw output if we ever want to look at that ourselves. But FastQC 
                                helpfully summarizes it with the HTML files. Double click on the file <code class="inline">pse-chr2_1_fastqc.html</code> 
                                to open the file in a new browswer tab.
                            </p>
            
                            <!-- <div id="msg_cont">
                                <div id="msg">
                                    <div id="msg_banner">Tip - Unblock pop-ups</div>
                                    <div id="msg_text">
                                        <p>
                                            The first time you select <code class="inline">View in Web Browser</code> you may get a warning that your browser does not allow pop-ups. There
                                            should also be an option to allow pop-ups from this site. Click on that option and the file should open in a new tab. If not, click on the file and
                                            select <code class="inline">View in Web Browser</code> again to open.
                                        </p>
                                        <p></p>
                                    </div>
                                </div>
                            </div> -->

                            <p></p>

                            <!-- <div class="row" id="img-row">
                                <div class="col-24-24" id="img-col">
                                    <img id="res-img" src="img/fastqc-screenshot.png">
                                    <center><span class="fig-caption">Figure 2.2: A screenshot of the RStudio interface showing how to view an HTML file.</span></center>
                                </div>
                            </div>                             -->

                            <p>Once you have it open, the FastQC output should display a number of plots and summary statistics which can be scrolled through or navigated to with the links on the left.</p>
            
                            <div class="row" id="img-row">
                                <div class="col-7-24" id="margin"></div>
                                <div class="col-10-24" id="img-col">
                                    <img id="res-img" src="img/fastqc-1.png">
                                    <center><span class="fig-caption">Figure 2.3: Basic FastQC statistics from <code class="inline">pse-chr2_1.fastq.gz</code>.</span></center>
                                </div>
                                <div class="col-7-24" id="margin"></div>
                            </div>
            
                            <p>This tells us we've sequenced <b>537507</b> reads that range from 30-151bp long (though the vast majority are 150bp). It also tells us that none of the reads
                                are considered low quality by FastQC. That's good! But let's take a look at the quality score distribution anyway:
                            </p>
            
                            <a name="fastqc-bq"></a>	
                            <div class="row" id="img-row">
                                <div class="col-6-24" id="margin"></div>
                                <div class="col-12-24" id="img-col">
                                    <img id="res-img" src="img/fastqc-2.png">
                                    <center><span class="fig-caption">Figure 2.4: Distribution of <b>Phred quality scores</b> based on position in read in <code class="inline">pse-chr2_1.fastq.gz</code>.</span></center>
                                </div>
                                <div class="col-6-24" id="margin"></div>
                            </div>
                            
                            <p>This shows that for most positions in most reads we have the highest quality score possible (40), with a bit of a drop-off towards the end of reads. This
                                drop-off towards the end is usually caused by <b>de-phasing</b>. De-phasing happens because of the random nature of sequencing by synthesis. At any given spot
                                on a flow-cell there may be thousands of cloned PCR fragments to be sequenced. During each cycle of the machine, nucleotides are washed over these spots and
                                incorporated into the sequence -- but not in 100% of the fragments at a given spot. Just by chance, some sequences may not be extended in a given cycle, adding
                                noise to the signal, which accumulates towards the ends of reads.
                            </p>
            
                            <p>Despite this, I would still say this is high-quality data. Just to see, here is an example of poorer quality data from the FastQC homepage:</p>
            
                            <div class="row" id="img-row">
                                <div class="col-6-24" id="margin"></div>
                                <div class="col-12-24" id="img-col">
                                    <img id="res-img" src="img/fastqc-3.png">
                                    <center><span class="fig-caption">Figure 2.5: An example of poor quality reads. 
                                        <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">Source</a>.</span></center>
                                </div>
                                <div class="col-6-24" id="margin"></div>
                            </div>
            
                            <p>The only red flag in our reads is adapter content. Recall that adapters are the short sequences of nucleotides that allow the cloned DNA fragments to
                                affix to the flowcell. Needless to say we wouldn't want to incorporate these sequences in our assemblies. Fortunately, most assemblers and read mappers
                                trim these off automatically.    
                            </p>
            
                            <p>There are several pre-processing tasks you could perform to filter your reads, including:</p>
            
                            <ol>
                                <li>Trimming adapters</li>
                                <li>Trimming low quality positions</li>
                                <li>Decontamination</li>
                                <li>Removal of duplicate reads</li>
                            </ol>
            
                            <p>But in general, I allow the assembly and mapping programs to handle these tasks. The one exception being the marking of duplicate reads after read
                                mapping, which is something we'll do in the <a href="mapping.html">Read mapping</a> section. But for now, let's move on to
                                <a href="assembly.html">Assembly</a>...
                            </p>
                                                
                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="assign"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Assignment: Assessing base quality</a></div>
                </div>
            </div>
            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
        
                            <p>
                                In groups of 3, write a script that takes as input a FASTQ file and outputs a table in TSV format that counts the number of bases with each Phred score.
                            </p>

                            <h3>Input and expected outputs</h3>
                            <p>
                                The output file should have 4 columns: Phred score, ASCII code, Probability of error, # of bases with score.
                            </p>

                            <p>
                                The output file should have 42 rows (excluding the header): 1 row for each Phred score from 0 to 41.
                            </p>

                            <p>
                                I will be using the <em>D. pseudoobscura</em> reads from lab to assess your script, so you should use those as your input data, but your code should
                                work on ANY FASTQ file!
                            </p>

                            <h3>Collaborative coding</h3>

                            <p>
                                Feel free to split up the work as you see fit, but collaborative coding is a team effort so everyone must contribute! Be sure to leave comments on chunks
                                of code/functions that indicate who wrote them.
                            </p>

                            <p>
                                A possible way to divide the work:
                            </p>

                            <ul>
                                <li>One group member writes the "scaffolding" code. This includes parsing input options (including error checking),
                                    data structure initialization, and writing output files.</li>
                                <li>One group member writes a function that reads the FASTQ file line-by-line, passing each line to a counting function.</li>
                                <li>One group member writes a function that takes a string of quality scores and counts the occurrence of each score, 
                                    adding that count to the overall counts.</li>
                            </ul>

                            <h3>Considerations</h3>

                            <p>What data structure will be best to use when tracking counts of each score?</p>

                            <h3>Example outputs</h3>

                            <p>
                                The table should be formatted as follows:
                            </p>

                            <div class="table-cont">
                                <table class="main-table">
                                    <thead><th class="tcol-1">Phred score</th><th class="tcol-1">ASCII character</th><th class="tcol-1">Error probability</th><th class="tcol-1">Number of bases with score</th></thead>
                                    <tr>
                                        <td class="tcol-1">0</td>
                                        <td class="tcol-1">!</td>
                                        <td class="tcol-1">1.0</td>
                                        <td class="tcol-1">0</td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1">1</td>
                                        <td class="tcol-1">"</td>
                                        <td class="tcol-1">0.7943282347242815</td>
                                        <td class="tcol-1">0</td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1">2</td>
                                        <td class="tcol-1">#</td>
                                        <td class="tcol-1">0.6309573444801932</td>
                                        <td class="tcol-1">10654</td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1">.</br>.</br>.</br></td>
                                        <td class="tcol-1"> </td>
                                        <td class="tcol-1"> </td>
                                        <td class="tcol-1"> </td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1">40</td>
                                        <td class="tcol-1">I</td>
                                        <td class="tcol-1">0.0001</td>
                                        <td class="tcol-1">0</td>
                                    </tr>

                                    <tr>
                                        <td class="tcol-1">41</td>
                                        <td class="tcol-1">J</td>
                                        <td class="tcol-1">7.943282347242822e-05</td>
                                        <td class="tcol-1">66987678</td>
                                    </tr>
                                </table>
                            </div> 
                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>


        </div>
    </div>

    <div class="row" id="btm-nav">
        <div class="col-3-24" id="nav-bnt-margin"></div>
        <div class="col-6-24" id="nav-btn-cont">
            <div class="nav-btn">
                <a href="start.html">&lt;&nbsp;Previous</a>    
            </div>
        </div>
        <div class="col-6-24" id="nav-margin"></div>
        <div class="col-6-24" id="nav-btn-cont">
            <div class="nav-btn">
                <a href="assembly.html">Next&nbsp;&gt;</a>
            </div>
        </div>
        <div class="col-3-24" id="nav-btn-margin"></div>
    </div>

    <!-- dynamically load mathjax for compatibility with self-contained -->
    <script>
        (function () {
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
            document.getElementsByTagName("head")[0].appendChild(script);
        })();
    </script>

    <div class="row" id="footer">
		<div class="col-1">
			<div id="footer_text">
				<center>Site designed and maintained by <a href="https://gwct.github.io" target="_blank">Gregg Thomas</a> | Page built: 01/19/2021 17:32:19 MST</center>
			</div>
		</div>
	</div>
</body>
