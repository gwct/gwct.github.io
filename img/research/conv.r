############################################################
# For website convergence figure, 08.18
#
# Gregg Thomas
############################################################

library(ggplot2)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
cat("----------\n")

total_com = c(193262,95746,107004,127158,125852,111824,124553,141228,148834,159247,177903,176445,163967,175616,190806,56589,77901,77074,61287,75272,93205,89581,88468,73150,87006,104450,108758,94232,107588,124535,93313,106469,123234,91790,109150,121728)
com = c(12173,2237,3436,5392,5934,3523,5347,7001,3728,5772,9226,9920,5959,8863,12002,978,1776,1839,1187,1755,2151,2553,2902,1781,2478,3363,4722,2809,4006,5388,2964,4361,5925,2601,3570,5545)
total_con = c(197877,96736,108581,129249,127949,113248,126699,143837,150438,161755,181424,180262,166857,179436,194943,57544,78620,77920,61747,75962,94158,90622,89859,74004,88039,105944,109757,94937,108849,126436,96207,108206,125045,92541,110679,127130)
con = c(7558,1247,1859,3301,3837,2099,3201,4392,2124,3264,5705,6103,3069,5043,7865,23,1057,993,727,1065,1198,1512,1511,927,1445,1869,3723,2104,2745,3487,70,2624,4114,1850,2041,143)

total_con_sim = c(124600,54594,61004,74195,73695,61861,73279,81528,93432,99795,112768,112239,100580,111876,120037,29172,42386,41891,29967,41520,49883,48853,48357,36412,47987,56289,61551,49614,61174,69453,49427,60714,68999,48832,57151,68997)
con_sim = c(1316,181,299,470,486,311,515,638,355,520,909,954,604,930,1141,2,150,161,76,145,154,211,223,159,206,276,391,319,381,474,22,357,444,230,283,59)

micro_dol_con=2041
micro_dol_com = 3570
micro_dol_total=110679
micro_cow_con=4114
micro_cow_com=5925
micro_cow_total=125045

#par(mfcol=c(2,1))
#com_reg = lm(com ~ total_com)
#plot(total_com,com)
#abline(com_reg)
#legend("topleft",bty="n",legend=paste("R^2 = ", format(summary(com_reg)$adj.r.squared, digits=4)))
#points(109150,3570,col="blue",pch=16)
#abort

png(filename="conv2.png")
par(mfcol=c(1,1),mar=c(5, 5, 2, 2) + 0.1,mgp=c(3.4,0.9,0))
com_con_reg = lm(con ~ com)

plot(com,con,xlab="Divergent substitutions",ylab="Convergent substitutions",cex.lab=2,cex=1.3,cex.axis=1.5,pch=20,bty='n')
abline(com_con_reg)

r2 = summary(com_con_reg)$adj.r.squared
leg = bquote(italic(R)^2 == .(format(r2, digits=4)))
legend("topleft",bty="n",legend=leg,cex=1.5)

points(3570,2041,col="black",pch=1,cex=2)
points(5925,4114,col="black",pch=1,cex=2)
text(3570+1750,2041-250,labels="Microbat-Dolphin")
text(5925-1000,4114+300,labels="Microbat-Cow")
dev.off()